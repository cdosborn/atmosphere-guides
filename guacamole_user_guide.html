<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="Content-Style-Type" content="text/css" />
        <meta name="generator" content="pandoc" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
                    <title>guacamole_guide</title>
        <style type="text/css">code{white-space: pre;}</style>
                    <style type="text/css">
      a.sourceLine { display: inline-block; line-height: 1.25; }
      a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
      a.sourceLine:empty { height: 1.2em; position: absolute; }
      .sourceCode { overflow: visible; }
      code.sourceCode { white-space: pre; position: relative; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      code.sourceCode { white-space: pre-wrap; }
      a.sourceLine { text-indent: -1em; padding-left: 1em; }
      }
      pre.numberSource a.sourceLine
        { position: relative; }
      pre.numberSource a.sourceLine:empty
        { position: absolute; }
      pre.numberSource a.sourceLine::before
        { content: attr(data-line-number);
          position: absolute; left: -5em; text-align: right; vertical-align: baseline;
          border: none; pointer-events: all;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  }
      @media screen {
      a.sourceLine::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        </style>
                    <link rel="stylesheet" href="./themes/cyverse/templates/main.css" />
                    <link rel="icon" href="themes/cyverse/media/favicon.ico" type="image/x-icon">
        <link rel="stylesheet" href="themes/cyverse/media/css/normalize.min.css">
        <link rel="stylesheet" href="themes/cyverse/media/css/main.css">
        <script src="themes/cyverse/media/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
          </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

                <div class="header-container">
            <header class="wrapper clearfix">
                <div class="logo"><img src="themes/cyverse/media/cyverse_logo.png" alt="Staff Guide"></div>
                <h1 class="title"></h1>
            </header>
        </div>
        
        <div class="main-container">
            <div class="main wrapper clearfix">
              <!-- TABLE OF CONTENTS -->
                                  <aside>
                      <h3> TABLE OF CONTENTS </h3>
                      <ul>
                      <li><a href="#using-web-shell-and-desktop-on-atmosphere">Using Web Shell and Desktop on Atmosphere</a><ul>
                      <li><a href="#general">General</a><ul>
                      <li><a href="#copypaste">Copy/Paste</a></li>
                      </ul></li>
                      <li><a href="#web-shell">Web Shell</a><ul>
                      <li><a href="#persisting-session-in-web-shell">Persisting Session in Web Shell</a><ul>
                      <li><a href="#tmuxscreen-crash-course">tmux/screen Crash Course</a></li>
                      </ul></li>
                      </ul></li>
                      <li><a href="#web-desktop">Web Desktop</a><ul>
                      <li><a href="#changing-resolution-of-web-desktop">Changing Resolution of Web Desktop</a></li>
                      </ul></li>
                      <li><a href="#possible-errors">Possible Errors</a><ul>
                      <li><a href="#connection-error---closed-the-connection">Connection Error - closed the connection</a></li>
                      <li><a href="#connection-error---do-not-have-permission">Connection Error - do not have permission</a></li>
                      <li><a href="#connection-error---failed-to-login">Connection Error - failed to login</a></li>
                      </ul></li>
                      </ul></li>
                      </ul>
                  </aside>
                              <!-- MAIN CONTENT -->
              <article>
              <h1 id="using-web-shell-and-desktop-on-atmosphere">Using Web Shell and Desktop on Atmosphere</h1>
              <p>This guide will help you to understand and use the Web Desktop and Web Shell on CyVerse’s Atmosphere platform. They are both powered by <a href="https://guacamole.apache.org/">Apache Guacamole</a>.</p>
              <p>The official Guacamole user guide can be found <a href="https://guacamole.apache.org/doc/gug/users-guide.html">here</a>, but please note that not all features will be available on Atmosphere.</p>
              <h2 id="general">General</h2>
              <p>Use <code>CTRL + ALT + SHIFT</code> to open a side menu. From here, you can browse system files and</p>
              <h3 id="copypaste">Copy/Paste</h3>
              <p>In order to copy and paste between your local computer and your instance using our Web Desktop and Web Shell, you must use the text box in the side menu. The reason that you cannot directly copy/paste is that most browsers have strict control of clipboard access. If you use Google Chrome, you can install <a href="https://chrome.google.com/webstore/detail/clipboard-permission-mana/ipbhneeanpgkaleihlknhjiaamobkceh">this extension</a> to allow access to your clipboard. A full explanation of this is available on the <a href="https://guacamole.apache.org/faq/#clipboard">Apache Guacamole website</a>.</p>
              <ul>
              <li>On Web Shell: text from your instance will appear in the text box if you highlight it. Paste text into the terminal by right-clicking.</li>
              </ul>
              <p><img src="./media/guac_shell_copypaste.gif" /></p>
              <ul>
              <li>On Web Desktop: use regular copy/paste methods: <code>CTRL+C</code>/<code>CTRL+V</code>, or right-click and find “Copy”/“Paste”. <em>Note that when using a Terminal within the Desktop, copy/paste commands change to <code>CTRL+SHIFT+C</code>/<code>CTRL+SHIFT+V</code></em></li>
              </ul>
              <p><img src="./media/guac_desktop_copypaste.gif" /></p>
              <h2 id="web-shell">Web Shell</h2>
              <ul>
              <li>Connect using the “Open Web Shell” button on the instance details page of Atmosphere.</li>
              <li>Uses SSH protocol with public key authentication to connect to your instance. The private keys are created and stored by Atmosphere and Guacamole.</li>
              </ul>
              <p><img src="./media/guac_open_shell.gif" /></p>
              <h3 id="persisting-session-in-web-shell">Persisting Session in Web Shell</h3>
              <p>When you close a Web Shell window, your shell session ends and is not preserved. You may wish to make your shell session persistent, so that you can disconnect from it and reconnect later. For this, we recommend using a terminal multiplexer, either <a href="https://en.wikipedia.org/wiki/Tmux"><code>tmux</code></a> or <a href="https://en.wikipedia.org/wiki/GNU_Screen"><code>screen</code></a> on your instance. Both of these may already be installed. Both can be used to keep your shell session active, and connect to it later, even if your browser disconnects.</p>
              <h4 id="tmuxscreen-crash-course">tmux/screen Crash Course</h4>
              <p>Create a new terminal multiplexer session and activate it:</p>
              <div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ex">tmux</span></a>
              <a class="sourceLine" id="cb1-2" data-line-number="2"><span class="ex">screen</span></a></code></pre></div>
              <p>Now you can do your work inside terminal multiplexer, and your session will be preserved even if you get disconnected.</p>
              <p>You can explicitly “detach” from your terminal multiplexer session by pressing <code>CTRL+B</code> in <code>tmux</code> or <code>CTRL+A</code> in <code>screen</code>, followed by pressing the <code>d</code> key – though this is not necessary when disconnecting Web Shell. You can just close the browser and your terminal multiplexer session will stay active.</p>
              <p>When you re-connect to Web shell, you can re-attach to the first available terminal multiplexer session (i.e. the one that you opened earlier) with:</p>
              <div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ex">tmux</span> a</a>
              <a class="sourceLine" id="cb2-2" data-line-number="2"><span class="ex">screen</span> -x</a></code></pre></div>
              <p>This should bring you back to the same shell, exactly where you were earlier! It’s possible to have more than one terminal multiplexer session open, and this may cause confusion. You can list all active terminal multiplexer sessions with:</p>
              <div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="ex">tmux</span> ls</a>
              <a class="sourceLine" id="cb3-2" data-line-number="2"><span class="ex">screen</span> -ls</a></code></pre></div>
              <p>If you see multiple sessions listed, you can connect to a named session (e.g. session 0) with</p>
              <div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ex">tmux</span> a -t 0</a>
              <a class="sourceLine" id="cb4-2" data-line-number="2"><span class="ex">screen</span> -x 0</a></code></pre></div>
              <p>For more information on using <code>tmux</code>, please see <code>tmux</code> documentation (e.g. <code>man tmux</code>) and other articles on the web (e.g. <a href="https://hackernoon.com/a-gentle-introduction-to-tmux-8d784c404340">A Gentle Introduction to <code>tmux</code></a>).</p>
              <p>For more information on using <code>screen</code>, please see <code>screen</code> documentation (e.g. <code>man screen</code>) and other articles on the web (e.g. <a href="https://wiki.archlinux.org/index.php/GNU_Screen">GNU Screen on Arch Wiki</a>).</p>
              <h2 id="web-desktop">Web Desktop</h2>
              <ul>
              <li>Connect using the “Open Web Desktop” button on the instance details page of Atmosphere.</li>
              <li>Uses VNC protocol.</li>
              </ul>
              <p><img src="./media/guac_open_desktop.gif" /></p>
              <h3 id="changing-resolution-of-web-desktop">Changing Resolution of Web Desktop</h3>
              <p>Open a terminal and use these commands:</p>
              <div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Show the available resolution options</span></a>
              <a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ex">xrandr</span> -q</a>
              <a class="sourceLine" id="cb5-3" data-line-number="3"></a>
              <a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Change the resolution using the resolution or the corresponding number.</span></a>
              <a class="sourceLine" id="cb5-5" data-line-number="5"><span class="ex">xrandr</span> -s <span class="op">&lt;</span>choice<span class="op">&gt;</span></a>
              <a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># Example: xrandr -s 1920x1080</span></a>
              <a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#       or xrandr -s 6</span></a></code></pre></div>
              <p><img src="./media/guac_change_resolution.gif" /></p>
              <h2 id="possible-errors">Possible Errors</h2>
              <h4 id="connection-error---closed-the-connection">Connection Error - closed the connection</h4>
              <p><img src="./media/guac_connection_error.png" /></p>
              <p>This means that you were successfully authenticated by the Guacamole server, but it was unable to connect to your instance. This could be an issue with the instance, or perhaps with the server. If it continues to happen after a few tries, contact support. The most likely problem is the VNC server closed.</p>
              <p>You can try to fix this yourself with these commands:</p>
              <div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Kill the Guacamole-specific VNC server</span></a>
              <a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># If you get an error, that means the server is already killed</span></a>
              <a class="sourceLine" id="cb6-3" data-line-number="3"><span class="ex">vncserver</span> -kill :5</a>
              <a class="sourceLine" id="cb6-4" data-line-number="4"></a>
              <a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># Restart the VNC server</span></a>
              <a class="sourceLine" id="cb6-6" data-line-number="6"><span class="ex">vncserver</span> -config ~/.vnc/config.guac :5</a></code></pre></div>
              <h4 id="connection-error---do-not-have-permission">Connection Error - do not have permission</h4>
              <p><img src="./media/guac_perm_err.png" /></p>
              <p>This means you are not authenticated for that connection. You have been authenticated by Guacamole but the instance you are trying to connect to is not your own. If you encounter this error, contact support.</p>
              <h4 id="connection-error---failed-to-login">Connection Error - failed to login</h4>
              <p><img src="./media/guac_login_fail.png" /></p>
              <p>This error occurs on SSH connections when the user mistypes the password or there is a key mismatch. If you still cannot connect after about 3 tries, contact support through Intercom so we can fix the SSH keys.</p>
              </article>
            </div> <!-- #main -->
        </div> <!-- #main-container -->

                <div class="footer-container">
            <footer class="wrapper">
                    <footer class="footer"> <!-- Needs to be a `include-after` -->
          		<div class="container">
          		  <div class="region region-footer">
          		    <section id="block-block-25" class="block block-block clearfix">
          		      <p><img alt="Cyverse" src="./media/cyverse_icon_transp2.png" style="width: 25px; height: 24px;">&nbsp;<a href="http://www.cyverse.org/">CyVerse</a> | <a href="http://www.cyverse.org/open-source">Open Source</a> | <img alt="NSF" src="./media/nsf1.gif" style="width: 25px; height: 25px;">&nbsp;</p>
          		    </section>
          		  </div>
          		</div>
        	    </footer>
            </footer>
        </div>
        <!-- Included at the end of body -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="themes/cyverse/media/js/vendor/jquery-1.11.2.min.js"><\/script>')</script>
        
        <script src="themes/cyverse/media/js/main.js"></script>
            </body>
</html>
